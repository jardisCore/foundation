# =============================================================================
# APPLICATION
# =============================================================================
DOCKER_HUB=headgent
COMPOSE_FILE=support/docker-compose.yml
COMPOSE_PROJECT_NAME=foundation

APP_ENV=dev
APP_DEBUG=false

# PHP
PHP_VERSION=8.3
# PHP Configuration
PHP_MEMORY_LIMIT=512M
PHP_MAX_EXECUTION_TIME=0
PHP_TIMEZONE=UTC
PHP_ERROR_REPORTING=E_ALL & ~E_DEPRECATED & ~E_STRICT
PHP_DISPLAY_ERRORS=Off
PHP_LOG_ERRORS=On
APCU_SHM_SIZE=64M
OPCACHE_MEMORY_CONSUMPTION=128
OPCACHE_MAX_ACCELERATED_FILES=4000
OPCACHE_REVALIDATE_FREQ=2
OPCACHE_JIT=1254
OPCACHE_JIT_BUFFER_SIZE=128M

# Xdebug Configuration (Runtime controllable)
# Default: debug mode for development (disables JIT automatically)
# Set to 'off' in production to enable JIT for maximum performance
XDEBUG_MODE=debug
XDEBUG_START_WITH_REQUEST=yes
XDEBUG_CLIENT_HOST=host.docker.internal
XDEBUG_CLIENT_PORT=9003
XDEBUG_LOG_LEVEL=0

# PCOV Configuration (Code Coverage)
# Set PCOV_ENABLED=1 to enable pcov for fast code coverage
# Note: pcov and xdebug coverage are mutually exclusive
PCOV_ENABLED=0

# =============================================================================
# DATABASE (jardiscore/dbconnection)
# =============================================================================
# ConnectionPool with 1 Writer + N Readers (Read/Write Splitting)
# All databases must use the same driver type in connection pool
# Writer Database (required - for INSERT/UPDATE/DELETE)
DB_WRITER_ENABLED=true
DB_WRITER_DRIVER=mysql
DB_WRITER_HOST=mysql_test
DB_WRITER_PORT=3306
DB_WRITER_HOST_PORT=3306
DB_WRITER_USER=app_user
DB_WRITER_PASSWORD=app_secret
DB_WRITER_DATABASE=test_db
DB_WRITER_CHARSET=utf8mb4
DB_WRITER_PERSISTENT=false
# Reader 1 - n (optional - for SELECT load balancing)
#DB_READER1_ENABLED=false
#DB_READER1_DRIVER=mysql
#DB_READER1_HOST=db-replica1.example.com
#DB_READER1_PORT=3306
#DB_READER1_USER=app_user
#DB_READER1_PASSWORD=replica_secret
#DB_READER1_DATABASE=test_db
#DB_READER1_CHARSET=utf8mb4
#DB_READER1_PERSISTENT=false

# MariaDB (Test Service)
DB_MARIADB_HOST_PORT=3308
# PostgreSQL (Test Service)
DB_POSTGRES_HOST_PORT=5432

# Multi-layer caching: memory, apcu, redis, database
CACHE_MEMORY_ENABLED=false
CACHE_APCU_ENABLED=true
CACHE_REDIS_ENABLED=true
CACHE_DB_ENABLED=false
# Cache namespace (prevents key collisions)
CACHE_NAMESPACE=integration_test
# Redis konfiguration
CACHE_REDIS_HOST=redis_test
CACHE_REDIS_PORT=6379
CACHE_REDIS_HOST_PORT=6380
CACHE_REDIS_PASSWORD=
CACHE_REDIS_DATABASE=0

CACHE_DB_TABLE=cache

# =============================================================================
# LOGGER (jardiscore/logger) - Flat ENV Configuration
# =============================================================================
# Logger Defaults
LOG_DEFAULT_LEVEL=INFO
LOG_DEFAULT_FORMAT=json
LOG_DEFAULT_ALWAYS=false

# Log Handler 1: Application Log (File)
LOG_HANDLER1_TYPE=file
LOG_HANDLER1_NAME=app_log
LOG_HANDLER1_LEVEL=INFO
LOG_HANDLER1_FORMAT=json
LOG_HANDLER1_PATH=/tmp/app.log

# Log Handler 2: Error Log (File)
LOG_HANDLER2_TYPE=file
LOG_HANDLER2_NAME=error_log
LOG_HANDLER2_LEVEL=ERROR
LOG_HANDLER2_FORMAT=json
LOG_HANDLER2_PATH=/tmp/error.log

LOG_HANDLER3_TYPE=console
LOG_HANDLER3_NAME=console_debug
LOG_HANDLER3_LEVEL=ERROR

# Log Handler 4: Syslog
LOG_HANDLER4_TYPE=syslog
LOG_HANDLER4_NAME=sys_log
LOG_HANDLER4_LEVEL=INFO
LOG_HANDLER4_FACILITY=LOG_USER

# Further samples (commented out):
# Database Handler
#LOG_HANDLER5_TYPE=database
#LOG_HANDLER5_NAME=db_errors
#LOG_HANDLER5_LEVEL=ERROR
#LOG_HANDLER5_TABLE=application_logs

# Slack Handler
#LOG_HANDLER6_TYPE=slack
#LOG_HANDLER6_NAME=critical_alerts
#LOG_HANDLER6_LEVEL=CRITICAL
#LOG_HANDLER6_WEBHOOK=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK
#LOG_HANDLER6_TIMEOUT=10
#LOG_HANDLER6_RETRY=3

# Teams Handler
#LOG_HANDLER7_TYPE=teams
#LOG_HANDLER7_NAME=team_errors
#LOG_HANDLER7_LEVEL=ERROR
#LOG_HANDLER7_WEBHOOK=https://outlook.office.com/webhook/YOUR/TEAMS/WEBHOOK

# Loki Handler
#LOG_HANDLER8_TYPE=loki
#LOG_HANDLER8_NAME=loki_prod
#LOG_HANDLER8_LEVEL=WARNING
#LOG_HANDLER8_URL=http://loki:3100/loki/api/v1/push
#LOG_HANDLER8_LABELS=app:foundation,env:dev

# Webhook Handler
#LOG_HANDLER9_TYPE=webhook
#LOG_HANDLER9_NAME=custom_hook
#LOG_HANDLER9_LEVEL=ERROR
#LOG_HANDLER9_URL=https://example.com/log-webhook

# For advanced logger strategies (Sampling, FingersCrossed, Conditional),
# see .env.logger.samples for detailed examples and best practices.

# =============================================================================
# MESSAGE BROKER (jardiscore/messaging)
# =============================================================================
# Message broker with priority-based fallback
# InMemory (synchronous in-process messaging - no external broker needed)
MESSAGING_INMEMORY_ENABLED=false
MESSAGING_INMEMORY_PRIORITY=99

# Redis Messaging (Priority 0)
MESSAGING_REDIS_ENABLED=true
MESSAGING_REDIS_HOST=redis_test
MESSAGING_REDIS_PORT=6379
MESSAGING_REDIS_PASSWORD=
MESSAGING_REDIS_USE_STREAMS=true

# Kafka (Priority 1 - optional)
MESSAGING_KAFKA_ENABLED=true
MESSAGING_KAFKA_BROKERS=kafka_test:29092
MESSAGING_KAFKA_HOST_PORT=9092
MESSAGING_KAFKA_USERNAME=
MESSAGING_KAFKA_PASSWORD=
MESSAGING_KAFKA_GROUP_ID=integration_test

# RabbitMQ (Priority 2 - optional)
MESSAGING_RABBITMQ_ENABLED=true
MESSAGING_RABBITMQ_HOST=rabbitmq_test
MESSAGING_RABBITMQ_PORT=5672
MESSAGING_RABBITMQ_HOST_PORT=5672
MESSAGING_RABBITMQ_MANAGEMENT_PORT=15672
MESSAGING_RABBITMQ_USERNAME=guest
MESSAGING_RABBITMQ_PASSWORD=guest
MESSAGING_RABBITMQ_QUEUE=integration_test
